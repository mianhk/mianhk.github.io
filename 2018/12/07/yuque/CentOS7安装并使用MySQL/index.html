<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content=" CentOS7安装并使用MySQL"/><meta name="keywords" content="MySQL, 学习, mianhk" /><link rel="alternate" href="/atom.xml" title="mianhk"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://www.yuguocong.cn/2018/12/07/yuque/CentOS7安装并使用MySQL/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title> CentOS7安装并使用MySQL - mianhk</title>
  <meta name="generator" content="Hexo 4.2.1"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">mianhk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">mianhk</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title"> CentOS7安装并使用MySQL
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-12-07
        </span><span class="post-category">
            <a href="/categories/MySQL/">MySQL</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#yum-安装"><span class="toc-text">yum 安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#问题记录"><span class="toc-text">问题记录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-状态查看-灰色"><span class="toc-text">1.状态查看-灰色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-错误：2002"><span class="toc-text">2.错误：2002</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-错误：service-failed"><span class="toc-text">3.错误：service failed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-错误：登录问题"><span class="toc-text">4.错误：登录问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-修改密码"><span class="toc-text">5.修改密码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-外网连接-mysql"><span class="toc-text">6.外网连接 mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql5-7"><span class="toc-text">MySQL5.7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql8-0"><span class="toc-text">MySQL8.0</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用过程问题"><span class="toc-text">使用过程问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-导入数据出错"><span class="toc-text">1.导入数据出错</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考："><span class="toc-text">参考：</span></a></li></ol>
    </div>
  </div><div class="post-content"><blockquote>
<p>MySQL 在 CentOS 上的安装和使用</p>
</blockquote>
<a id="more"></a>  
<h1 id="yum-安装">yum 安装</h1>
<p>date: 2018-12-9 21:57:59
update: 2018-12-9 21:57:59 1.首先找到官网 yum 的地址：<a href="https://dev.mysql.com/downloads/repo/yum/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/repo/yum/</a>，找到 redhat 的版本<strong>Red Hat Enterprise Linux 7 / Oracle Linux 7 (Architecture Independent), RPM Package</strong>,并复制 download 的地址，然后下载下来：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</span><br></pre></td></tr></table></figure>
<p>2.进行 rpm 解包并安装 mysql-server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh mysql-community-release-el7-5.noarch.rpm</span><br><span class="line">yum update</span><br><span class="line">yum install mysql-server</span><br></pre></td></tr></table></figure>
<p>3.修改权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown mysql:mysql -R /var/lib/mysql</span><br></pre></td></tr></table></figure>
<p>4.然后就可以启动 mysql 了。。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mysqld</span><br></pre></td></tr></table></figure>
<h1 id="问题记录">问题记录</h1>
<p>当然，看着上面好像很爽，很快的样子，但是没想到接下来坑还是很多的。都有点怀疑自己了，到现在装个 mysql 还这么多问题。关键是，网上的解决办法，都是什么乱七八糟的。</p>
<h2 id="1-状态查看-灰色">1.状态查看-灰色</h2>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ systemctl status mysqld</span><br><span class="line">● mysqld.service - MySQL Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line">     Docs: man:mysqld(<span class="number">8</span>)</span><br><span class="line">           http://dev.mysql.com/doc/refman/en/using<span class="literal">-systemd</span>.html</span><br><span class="line"></span><br><span class="line">➜  ~ ps ajx | grep mysql</span><br><span class="line"> <span class="number">1768</span>  <span class="number">1784</span>  <span class="number">1784</span>  <span class="number">1784</span> ?           <span class="literal">-1</span> Ssl    <span class="number">999</span>   <span class="number">0</span>:<span class="number">19</span> mysqld</span><br></pre></td></tr></table></figure>
<p>1.看了一下版本号，没错是 8.0：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ mysqladmin --version</span><br><span class="line">mysqladmin  Ver 8.0.13 <span class="keyword">for</span> Linux on x86_64 (MySQL Community Server - GPL)</span><br></pre></td></tr></table></figure>
<p>2.然后 mysql 连一波，出问题，连不上：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ mysql</span><br><span class="line">ERROR 2002 (HY000): Can<span class="string">'t connect to local MySQL server through socket '</span>/var/lib/mysql/mysql.sock<span class="string">' (2)</span></span><br></pre></td></tr></table></figure>
<p>看样子是没有这个 socket，应该是位置不对，于是<code>sudo find / -name mysql.sock</code>赶紧搜一下，什么都没有，没有办法，重启一下试试吧。 3.重启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ sudo systemctl restart mysqld</span><br><span class="line">Job <span class="keyword">for</span> mysqld.service failed because the control process exited with error code. See <span class="string">"systemctl status mysqld.service"</span> and <span class="string">"journalctl -xe"</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<p>不行，换种方式重启看看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ service mysqld start</span><br><span class="line">Redirecting to /bin/systemctl start mysqld.service</span><br><span class="line">==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===</span><br><span class="line">Authentication is required to manage system services or units.</span><br><span class="line">Authenticating as: root</span><br><span class="line">Password:</span><br><span class="line">polkit-agent-helper-1: pam_authenticate failed: Authentication failure</span><br><span class="line">==== AUTHENTICATION FAILED ===</span><br><span class="line">Failed to start mysqld.service: Access denied</span><br><span class="line">See system logs and <span class="string">'systemctl status mysqld.service'</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<h2 id="2-错误：2002">2.错误：2002</h2>
<p>错误详情：
ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/lib/mysql/mysql.sock’ (2)</p>
<p>这个错误网上找了一下，有看起来还可以的处理:<a href="http://blog.51cto.com/pengjc/1861088" target="_blank" rel="noopener">http://blog.51cto.com/pengjc/1861088</a> 。但是实际上我打开都没有这个文件，搜也没有搜到，于是放弃，这个问题应该不算个问题，先放着解决别的。</p>
<h2 id="3-错误：service-failed">3.错误：service failed</h2>
<p>错误详情：
Job for mysqld.service failed because the control process exited with error code. See “systemctl status mysqld.service” and “journalctl -xe” for details.
看了一下网上的解决办法，说是由于权限的问题：<a href="https://www.cnblogs.com/ivictor/p/5146247.html" target="_blank" rel="noopener">https://www.cnblogs.com/ivictor/p/5146247.html</a> ，通过命令<code>chown mysql.mysql /var/run/mysqld/</code>，但是问题还是没有解决。  
看了一下<a href="https://stackoverflow.com/questions/42317139/job-for-mysqld-service-failed-see-systemctl-status-mysqld-service" target="_blank" rel="noopener">stackoverflow</a>上面的说法，先通过<code>tail -f /var/log/mysqld.log</code>查看一下,，但是我的这个问题不是因为没有权限，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜  ~  tail /var/<span class="built_in">log</span>/mysqld.log</span><br><span class="line">2018-12-07T09:13:21.651467Z 0 [ERROR] [MY-010119] [Server] Aborting</span><br><span class="line">2018-12-07T09:13:21.655750Z 0 [System] [MY-010910] [Server] /usr/sbin/mysqld: Shutdown complete (mysqld 8.0.13)  MySQL Community Server - GPL.</span><br><span class="line">2018-12-07T09:15:40.466437Z 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.13) starting as process 12759</span><br><span class="line">2018-12-07T09:15:40.965670Z 0 [ERROR] [MY-012681] [InnoDB] mmap(137428992 bytes) failed; errno 12</span><br><span class="line">2018-12-07T09:15:40.965740Z 1 [ERROR] [MY-012956] [InnoDB] Cannot allocate memory <span class="keyword">for</span> the buffer pool</span><br><span class="line">2018-12-07T09:15:40.965766Z 1 [ERROR] [MY-012930] [InnoDB] Plugin initialization aborted with error Generic error.</span><br><span class="line">2018-12-07T09:15:40.965794Z 1 [ERROR] [MY-010334] [Server] Failed to initialize DD Storage Engine</span><br><span class="line">2018-12-07T09:15:40.965949Z 0 [ERROR] [MY-010020] [Server] Data Dictionary initialization failed.</span><br><span class="line">2018-12-07T09:15:40.965977Z 0 [ERROR] [MY-010119] [Server] Aborting</span><br><span class="line">2018-12-07T09:15:40.966835Z 0 [System] [MY-010910] [Server] /usr/sbin/mysqld: Shutdown complete (mysqld 8.0.13)  MySQL Community Server - GPL.</span><br></pre></td></tr></table></figure>
<p>搜了一下这个问题：
<code>[ERROR] [MY-012681] [InnoDB] mmap(137428992 bytes) failed; errno 12</code>
看样子是内存映射出错，再通过命令<code>journalctl -xe</code>看一下,同时也找到了原因：原来是<strong>swap 分区是 0(https://blog.csdn.net/sxyandapp/article/details/77091007),于是一阵操作：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ free -m</span><br><span class="line">/dev/vda1            /                    ext4       noatime,acl,user_xattr 1 1</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            992         516         304           0         171         321</span><br><span class="line">Swap:             0           0           0</span><br><span class="line"></span><br><span class="line">➜  ~ dd <span class="keyword">if</span>=/dev/zero of=/swap bs=1M count=512</span><br><span class="line">dd: failed to open ‘/swap’: Permission denied</span><br><span class="line"></span><br><span class="line">➜  ~ sudo dd <span class="keyword">if</span>=/dev/zero of=/swap bs=1M count=512</span><br><span class="line">512+0 records <span class="keyword">in</span></span><br><span class="line">512+0 records out</span><br><span class="line">536870912 bytes (537 MB) copied, 4.01658 s, 134 MB/s</span><br><span class="line"></span><br><span class="line">➜  ~ sudo mkswap /swap</span><br><span class="line">Setting up swapspace version 1, size = 524284 KiB</span><br><span class="line">no label, UUID=9bbac588-e6ee-4b1c-a398-4ac460ad476a</span><br><span class="line"></span><br><span class="line">➜  ~ sudo swapon /swap</span><br><span class="line">swapon: /swap: insecure permissions 0644, 0600 suggested.</span><br><span class="line"></span><br><span class="line">➜  ~ free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            992         516          64           0         410         317</span><br><span class="line">Swap:           511           0         511</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vi /etc/fstab</span><br><span class="line"><span class="comment">#在其中添加如下一行,保证下次系统启动后，此swap分区被自动加载，需要修改系统的fstab文件</span></span><br><span class="line">/swap swap swap defaults 0 0</span><br></pre></td></tr></table></figure>
<p>之后再重启就好了。</p>
<h2 id="4-错误：登录问题">4.错误：登录问题</h2>
<p>错误详情：
error: ‘Access denied for user ‘root’@‘localhost’ (using password: NO)’</p>
<p>这个其实是密码的问题，没有设置密码的时候，mysql 会生成一个临时的密码，通过命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ sudo grep <span class="string">'temporary password'</span> /var/<span class="built_in">log</span>/mysqld.log</span><br><span class="line">2018-12-07T09:08:22.908621Z 5 [Note] [MY-010454] [Server] A temporary password is generated <span class="keyword">for</span> root@localhost: TdqPeZ-n;4Ah</span><br></pre></td></tr></table></figure>
<p>可以看到生成的临时密码，然后用临时密码登录即可。</p>
<h2 id="5-修改密码">5.修改密码</h2>
<p>可能因为 8.0 的版本，修改的密码不能过于简单，并且命令好像也有些不一样了，用的是``</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'MyNewPass'</span>;</span><br></pre></td></tr></table></figure>
<p>看到一个别人的回答：
<img src="https://cdn.nlark.com/yuque/0/2018/png/187932/1544177770052-39cd9fe0-1c11-4059-be21-08de2d19446b.png#align=left&amp;display=inline&amp;height=148&amp;originHeight=148&amp;originWidth=695&amp;status=done&amp;width=695" alt="">
应该是后面才改的？</p>
<h1 id="6-外网连接-mysql">6.外网连接 mysql</h1>
<p>由于两台服务器的版本有点不一样，修改外网连接也有点不一样。</p>
<h2 id="mysql5-7"><a href="https://blog.csdn.net/w20228396/article/details/70143500" target="_blank" rel="noopener">MySQL5.7</a></h2>
<p>1.修改配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改配置文件</span></span><br><span class="line">sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf   <span class="comment"># bind-address=127.0.0.1 修改成 bind-address=0.0.0.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">service mysql restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加远程连接mysql的账号</span></span><br><span class="line">&gt; grant all on *.* to root@<span class="string">'%'</span> identified by <span class="string">'123456'</span>;</span><br><span class="line">&gt; flush privileges;</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">*.*          第一个*表示库，第二个*表示表; *.*对全部数据库的全部表授权，so.ok 表示只对so这个库中的ok表授权</span><br><span class="line">root        表示要给哪个用户授权，这个用户可以是存在的用户，也可以是不存在的</span><br><span class="line"><span class="string">'%'</span>          表示允许远程连接的IP地址，%代表允许所有IP连接</span><br></pre></td></tr></table></figure>
<h2 id="mysql8-0"><a href="https://stackoverflow.com/questions/50177216/how-to-grant-all-privileges-to-root-user-in-mysql-8-0" target="_blank" rel="noopener">MySQL8.0</a></h2>
<p>8.0 的版本总结的对权限的管理严格很多，毕竟数据很重要，只有安全才能放心。尝试过上述方式，但是连接不上。最终在 Stack Overflow 上找到了办法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER <span class="string">'root'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'root'</span>;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'root'</span>@<span class="string">'%'</span> WITH GRANT OPTION;</span><br></pre></td></tr></table></figure>
<p>但是修改之后还是会有问题，出现了 2059 错误：  
<img src="https://cdn.nlark.com/yuque/0/2018/png/187932/1544449883818-59e9985f-7a74-47f5-954e-4e8aa80ced7c.png#align=left&amp;display=inline&amp;height=129&amp;originHeight=129&amp;originWidth=586&amp;status=done&amp;width=586" alt="">
解决方式可以采用修改密码为简单密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET GLOBAL validate_password.policy=0;</span><br><span class="line">ALTER USER <span class="string">'root'</span>@<span class="string">'%'</span> IDENTIFIED WITH mysql_native_password BY <span class="string">'12345678'</span>;</span><br></pre></td></tr></table></figure>
<h1 id="使用过程问题">使用过程问题</h1>
<h2 id="1-导入数据出错">1.导入数据出错</h2>
<p>错误代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &#39;&#x2F;home&#x2F;mianhk&#x2F;pet.txt&#39; INTO TABLE pet;</span><br><span class="line">ERROR 1148 (42000): The used command is not allowed with this MySQL version</span><br><span class="line"></span><br><span class="line">mysql&gt; LOAD DATA INFILE &#39;&#x2F;home&#x2F;mianhk&#x2F;pet.txt&#39; INTO TABLE pet;</span><br><span class="line">ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it ca</span><br><span class="line">nnot execute this statement</span><br><span class="line"></span><br><span class="line">mysql&gt; LOAD DATA INFILE &#39;&#x2F;home&#x2F;mianhk&#x2F;pet.txt&#39; INTO TABLE pet LINES TERMINATED BY &#39;\r\n&#39;;</span><br><span class="line">ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it ca</span><br><span class="line">nnot execute this statement</span><br></pre></td></tr></table></figure>
<p>原因：
secure_file_priv 设置了指定目录，需要在指定的目录下进行数据导出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &#39;%secure%&#39;;</span><br><span class="line">+--------------------------+-----------------------+</span><br><span class="line">| Variable_name            | Value                 |</span><br><span class="line">+--------------------------+-----------------------+</span><br><span class="line">| require_secure_transport | OFF                   |</span><br><span class="line">| secure_file_priv         | &#x2F;var&#x2F;lib&#x2F;mysql-files&#x2F; |+--------------------------+-----------------------+</span><br><span class="line">2 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>数据导入需要注意的:</p>
<ul>
<li>空值要用 <code>\N</code>  代替，而不能直接使用空</li>
<li>分隔符一般用 <code>tab</code></li>
<li>注意换行符</li>
</ul>
<h1 id="总结">总结</h1>
<p>总之，感觉之前 windows 和 ubuntu 下都没有这么麻烦，这里总结一下吧，感觉以后会用的很多，不想踩坑了。</p>
<h1 id="参考：">参考：</h1>
<p><a href="https://juejin.im/entry/5af5d2786fb9a07aaf3547cc" target="_blank" rel="noopener">MySQL8.0.11 连接错误 2059 解决方法</a>
<a href="https://stackoverflow.com/questions/50177216/how-to-grant-all-privileges-to-root-user-in-mysql-8-0" target="_blank" rel="noopener">How to grant all privileges to root user in MySQL 8.0</a>
<a href="https://www.cnblogs.com/echo-coding/p/9172636.html" target="_blank" rel="noopener">centos mysql 初探 – 配置、基本操作及问题</a></p>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="http://www.yuguocong.cn">mianhk</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="http://www.yuguocong.cn/2018/12/07/yuque/CentOS7%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8MySQL/">http://www.yuguocong.cn/2018/12/07/yuque/CentOS7%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8MySQL/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/MySQL/">MySQL</a>
            <a href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2018/12/16/yuque/2018%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">2018年终总结</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2018/11/14/yuque/%E4%BD%BF%E7%94%A8%E8%AF%AD%E9%9B%80%E7%BC%96%E8%BE%91%E5%99%A8%E5%86%99%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/">
        <span class="next-text nav-default"> 使用语雀编辑器写静态博客</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:gcyu25@gmail.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/mianhk" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2021<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">mianhk</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
