---
title: 《c++primer》ch7 类
date: 2017-6-27 17:55:33
categories: C++
tags: C++
toc: true
---
> 类是面向对象编程的基础，使用类定义自己的数据类型，可以更方便的解决问题中的各种概念，使我们更容易编写、调试和修改程序。

<!-- more -->
### 7.1 定义抽象的数据类型
* 定义在类内部的函数时隐式的inline函数。
* 类的所有成员都必须在类的内部声明，但是成员函数体可以定义在类的内部或外部。
* 成员函数通过一个名为this的额外的隐式参数来访问调用它的那个对象。当我们调用一个成员函数时，用请求该函数的对象地址初始化this。
* 成员函数体可以随意使用类中的其他成员而不需要在意这些成员出现的次序。

#### 构造函数
编译器创建的构造函数又被称为合成的默认构造函数，合成的默认构造函数初始化类的数据成员规则为：存在类内初始值的时候，用它来初始化成员；否则，默认初始化该成员。
对于一个普通的类，一般要定义自己的默认构造函数：
1. 编译器只有在发现类不包含任何构造函数的情况下才会替我们生成一个默认的构造函数。
2. 对于某些类来说，合成的默认构造函数可能执行错误的操作。
3. 有的时候编译器不能为某些类合成默认的构造函数。
* 构造函数没有返回类型。

#### 拷贝。赋值和析构
除了定义类的对象如何初始化之外，类还需要控制拷贝、赋值和销毁对象的时候发生的行为。
当我们不主动定义这些操作的的时候，编译器将替我们合成他们。但是有些类不能依赖于合成的版本。当类需要分配类对象之外的资源时，合成的版本常常会失效。

### 7.2 访问控制与封装
在类的定义中，可以包含0个或多个访问说明符，每个访问说明符指定接下来的成员访问级别，一般来说，作为接口的一部分，构造函数和一部分成员函数应该定义在public说明符之后，而数据成员和作为实现部分的函数跟在private说明符之后。
class和struct唯一的区别是默认访问权限不同。

### 7.3 类的其他特性
类型成员、类的成员的类内初始值、可变数据成员、内联数据成员、从成员函数返回*this、关于如何定义类类型及友元类等。
#### 类成员
除了定义数据和函数成员之外，类还可以自定义某种类型在类中的别名。由类定义的类型名字和其他成员一样存在访问限制。
#### 令成员作为内联函数
在类中，一些规模较小的函数常被定义为内联函数
两种方式：1、直接把函数定义放在类的内部
          2、把函数定义放在类的外部，显式的使用inline
* 一个const成员函数如果以引用的形式返回*this，那么它的返回类型将是常量引用。
* 在实践中，设计良好的代码常常包含很多的小函数，通过调用这些小函数，可以完成其他一组函数的“实际”工作。

#### 类类型
* 对于一个类来说，它的成员和其他任何类的成员都不是一回事。
* 类的声明：不完全类型的使用：可以定义指向这种类型的指针或引用，也可以声明（但不能完全定义）以不完全类型作为参数或者返回类型的函数。

#### 友元
如果一个类指定了友元类，则友元类的成员函数可以访问此类中包括非公有成员在内的所有成员。
* 还可以另一个类的成员函数为自己的友元。
* 如果一个类想把一组重载函数声明称它的友元，需要对每一个分别声明。
* 友元关系不存在传递性。每个类负责控制自己的友元类或友元函数。

### 类的作用域
* 一个类就是一个作用域
* 函数的返回类型通常出现在函数名之前，所以返回类型是在类的作用域外的。
* 名字查找规则：首先名字所在快寻找声明语句；查找外层作用；报错。

#### 构造函数再探
* 如果成员是const或引用的话，必须进行初始化；当成员属于某种类类型且该类没有定义构造函数时，也必须初始化。
* 使用构造函数初始值：不仅仅是底层效率的问题。另有一些数据成员必须被初始化。
* 成员初始化顺序：构造函数初始化列表值说明用于初始化成员的值，而不限定初始化的具体执行顺序。（尽量按照顺序初始化，并且避免使用某些成员初始化其他成员）
* 委托构造函数：
* 默认构造函数的作用：当对象被默认初始化或值初始化时自动执行默认构造函数
* 默认初始化发生:
1. 块作用域内不适用任何初始值定义一个非静态变量或数组时。
2. 一个类本身含有类类型的成员且使用合成的默认构造函数。
3. 类类型的成员没有在构造函数初始值列表中显式的初始化。
* 值初始化发生：
1. 数组初始化时提供的初始值数量小于数组的大小
2. 不使用初始值定义一个局部的静态变量
3. 书写形如T()的表达式显式的请求值初始化

* 隐式的类类型转换：能通过一个实参调用的构造函数定义一条从构造函数的参数类型向类类型隐式转换的规则：
```
string null_book="2132321";
item.combine(null_book);//将一个string的实参传递给了combine成员。
```
* 隐式类型转换只能一步，可以使用explicit阻止隐式类型转换。
* 字面值常量类至少提供一个constexpr构造函数
### 类的静态成员


